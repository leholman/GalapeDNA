write.csv(MammOut,"cleandata/Cleaned_Mammals_wTAX.csv")
##OTHERS
##FISH
FishOut <- fishdat_p_collapsed_wTAX_3[!(fishdat_p_collapsed_wTAX_3$B.class%in%c("Mammalia","Aves","Lepidosauria","Mamiellophyceae","Demospongiae")),]
#somehow green turtle escapes the non-fish purge
FishOut <- FishOut[-match("Testudines",FishOut$B.order),]
View(FishOut)
FishOut[is.na(FishOut)] <- ""
write.csv(FishOut,"cleandata/Cleaned_Fish_wTAX.csv")
unique(fishdat_p_collapsed_wTAX_3$B.class)
rownames(FishOut)
match(c(rownames(FishOut),rownames(BirdOut),rownames(MammOut)),rownames(fishdat_p_collapsed_wTAX_3))
fishdat_p_collapsed_wTAX_3[match(c(rownames(FishOut),rownames(BirdOut),rownames(MammOut)),rownames(fishdat_p_collapsed_wTAX_3))]
fishdat_p_collapsed_wTAX_3[match(c(rownames(FishOut),rownames(BirdOut),rownames(MammOut)),rownames(fishdat_p_collapsed_wTAX_3)),]
test <- fishdat_p_collapsed_wTAX_3[match(c(rownames(FishOut),rownames(BirdOut),rownames(MammOut)),rownames(fishdat_p_collapsed_wTAX_3)),]
test <- fishdat_p_collapsed_wTAX_3[-match(c(rownames(FishOut),rownames(BirdOut),rownames(MammOut)),rownames(fishdat_p_collapsed_wTAX_3)),]
View(test)
##FISH
FishOut <- fishdat_p_collapsed_wTAX_3[!(fishdat_p_collapsed_wTAX_3$B.class%in%c("Mammalia","Aves","Lepidosauria","Mamiellophyceae","Demospongiae")),]
#somehow green turtle escapes the non-fish purge
FishOut <- FishOut[-match("Testudines",FishOut$B.order),]
FishOut[is.na(FishOut)] <- ""
write.csv(FishOut,"cleandata/Cleaned_Fish_wTAX.csv")
##BIRDS
BirdOut <- fishdat_p_collapsed_wTAX_3[fishdat_p_collapsed_wTAX_3$B.class=="Aves",]
BirdOut  <- BirdOut[!is.na(BirdOut[,1]),]
write.csv(BirdOut,"cleandata/Cleaned_Birds_wTAX.csv")
##MAMMALS
MammOut <- fishdat_p_collapsed_wTAX_3[fishdat_p_collapsed_wTAX_3$B.class=="Mammalia",]
MammOut  <- MammOut[!is.na(MammOut[,1]),]
write.csv(MammOut,"cleandata/Cleaned_Mammals_wTAX.csv")
##OTHERS
OtherOut <- fishdat_p_collapsed_wTAX_3[-match(c(rownames(FishOut),rownames(BirdOut),rownames(MammOut)),rownames(fishdat_p_collapsed_wTAX_3)),]
write.csv(OtherOut,"cleandata/Cleaned_Others_wTAX.csv")
####====1.0 Pull in Data ====####
fishdat <- read.csv("cleandata/Cleaned_Fish_wTAX.csv")
View(fishdat)
####====1.0 Pull in Data ====####
fishdat <- read.csv("cleandata/Cleaned_Fish_wTAX.csv",rownames=1)
####====1.0 Pull in Data ====####
fishdat <- read.table("cleandata/Cleaned_Fish_wTAX.csv",rownames=1)
/read.csv
?read.csv
####====1.0 Pull in Data ====####
fishdat <- read.csv("cleandata/Cleaned_Fish_wTAX.csv",row.names=1)
View(fishdat)
colnames(fishdat)
colnames(fishdat)[70:86]
fishAssign <- fishdat[,70:86]
fishdat <- fishAll[,1:69]
####====1.0 Pull in Data ====####
fishAll <- read.csv("cleandata/Cleaned_Fish_wTAX.csv",row.names=1)
fishAssign <- fishAll[,70:86]
fishdat <- fishAll[,1:69]
View(fishdat)
colnames(fishdat)
strsplit(colnames(fishdat),".")
strsplit(colnames(fishdat),".")[[1]]
/strsplit
?strsplit
strsplit(colnames(fishdat),"\\.")[[1]]
strsplit(colnames(fishdat),"\\.")
lapply(strsplit(colnames(fishdat),"\\."), `[[`, 1)
unlist(lapply(strsplit(colnames(fishdat),"\\."), `[[`, 1))
sites <- unlist(lapply(strsplit(colnames(fishdat),"\\."), `[[`, 1))
#Get the metadata
metadat <- read.csv("metadata.csv")
View(metadat)
metadatSites <- read.csv("metadata.site.out.csv")
View(metadatSites)
metadatSites <- read.csv("metadata.site.out.csv",row.names=1)
View(metadatSites)
sites
unique(sites)
fishdatSite <- as.data.frame(matrix(ncol=length(unique(sites)),nrow=dim(fishdat[1])))
View(fishdatSite)
colnames(fishdatSite) <- sites
colnames(fishdatSite) <- unique(sites)
colnames(fishdatSite) <- unique(sites)
rownames(fishdatSite) <- rownames(fishdat)
View(fishdatSite)
sites
column <- "BAR"
sites==column
for (column in colnames(fishdatSite)){
running <- fishdat[,sites==column]
fishdatSite[,colnames(fishdatSite)==column] <- rowMeans(running)
}
View(running)
View(fishdatSite)
fishdatB <- fishdat
fishdatB[fishdatB>1] <- 1
View(fishdatB)
View(fishdatB)
fishdatB[fishdatB>0] <- 1
View(fishdatB)
names(fishdatB)
fishdatB <- fishdatSite
fishdatB[fishdatB>0] <- 1
fishAlpha <- data.frame("ID"=names(fishdatB),"MiFishU"= colSums(temp))
fishdatB <- fishdatSite
fishdatB[fishdatB>0] <- 1
fishAlpha <- data.frame("ID"=names(fishdatB),"MiFishU"= colSums(fishdatB))
View(fishAlpha)
fishAlpha <- data.frame("ID"=names(fishdatB),"Richness"= colSums(fishdatB))
View(fishAlpha)
fishAlpha$ID
plot(as.numeric(as.factor(fishAlpha$ID)),fishAlpha$Richness,
col=as.numeric(as.factor(fishAlpha$ID)),
pch=16,
cex=2.5,
ylab="OTUs",
xlab="",
xaxt='n',
main="MiFishU OTU Richness"
)
match(fishAlpha$ID,metadat$island)
match(fishAlpha$ID,metadat$SiteID)
View(metadatSites)
match(fishAlpha$ID,metadatSites$SiteID)
metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)]
plot(as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),fishAlpha$Richness,
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),
pch=16,
cex=2.5,
ylab="OTUs",
xlab="",
xaxt='n',
main="MiFishU OTU Richness"
)
axis(1,at=1:12,labels=levels(metadatSites$island),cex=0.2,las=2)
axis(1,at=1:12,labels=levels(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),cex=0.2,las=2)
plot(as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),fishAlpha$Richness,
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),
pch=16,
cex=2.5,
ylab="OTUs",
xlab="",
xaxt='n',
main="MiFishU OTU Richness"
)
axis(1,at=1:12,labels=levels(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),cex=0.2,las=2)
####====0.0 Packages====####
library(vegan)
library("RColorBrewer")
#Set the seed
set.seed("123456")
palette(brewer.pal(12, "Set3"))
par(mfrow=c(1,2))
temp <- rMiU.site
temp[temp > 1] <- 1
Coastal.alpha <- data.frame("ID"=names(temp),"MiFishU"= colSums(temp))
plot(as.numeric(as.factor(metadat.site$island[match(as.character(Coastal.alpha$ID),metadat.site$SiteID)])),Coastal.alpha$MiFishU,
col=as.numeric(as.factor(metadat.site$island[match(as.character(Coastal.alpha$ID),metadat.site$SiteID)])),
pch=16,
cex=2.5,
ylab="OTUs",
xlab="",
xaxt='n',
main="MiFishU OTU Richness"
)
fishdatB <- fishdatSite
fishdatB[fishdatB>0] <- 1
fishAlpha <- data.frame("ID"=names(fishdatB),"Richness"= colSums(fishdatB))
plot(as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),fishAlpha$Richness,
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),
pch=16,
cex=2.5,
ylab="OTUs",
xlab="",
xaxt='n',
main="MiFishU OTU Richness"
)
axis(1,at=1:12,labels=levels(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),cex=0.2,las=2)
par(mfrow=c(1,1))
plot(as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),fishAlpha$Richness,
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),
pch=16,
cex=2.5,
ylab="OTUs",
xlab="",
xaxt='n',
main="MiFishU OTU Richness"
)
axis(1,at=1:12,labels=levels(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),cex=0.2,las=2)
?vegdist
####====3.0 ====####
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE))
metaMDS()
?metaMDS()
####====3.0 ====####
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),try=100)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),
main="")
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadat$island[match(fishAlpha$ID,metadat$SiteID)])),
main="")
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(sites)),
main="")
par(mfrow=c(1,1))
temp <- rMiU.site
nMDS <- metaMDS(vegdist(t(fishdatSite),method="jaccard",binary=TRUE),try=100)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(colnames(fishdatSite))),
main="")
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),try=100)
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),try=100)
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),try=100)
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=100)
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(colnames(fishdatSite))),
main="")
View(fishdat)
sites
metadatSites$island[match(sites,metadatSites$SiteID)]
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])),
main="")
metadatSites$island[match(sites,metadatSites$SiteID)]
#### Settings and Setup####
##Get metadata
metadat <- read.csv("metadata.csv")
metadat.site <- read.csv("metadata.site.csv")
metadat.site$lat2 <- as.numeric(paste0(ifelse(substr(metadat.site$latitude,1,1)=="S","-",""),substr(metadat.site$latitude,3,4),".",substr(as.character(as.numeric(paste0(substr(metadat.site$latitude,6,7),".",substr(metadat.site$latitude,9,11)))/60),3,20)))
metadat.site$lon2 <- as.numeric(paste0(ifelse(substr(metadat.site$longitude,1,1)=="W","-",""),substr(metadat.site$longitude,4,5),".",substr(as.character(as.numeric(paste0(substr(metadat.site$longitude,8,9),".",substr(metadat.site$longitude,11,13)))/60),3,20)))
write.csv(metadat.site,file = "metadata.site.out.csv")
# Load packages
library(ncdf4)
library(raster)
gebco.crop <- readRDS("mapBuilding/GalapBathy.rds")
#load lat lon
metadata <- read.csv(file = "metadata.site.out.csv")
#function to calculate break points for colours from https://www.benjaminbell.co.uk/2019/08/bathymetric-maps-in-r-colour-palettes.html
## x = raster, b1 & b2 = number of divisions for each sequence, r1 & r2 = rounding value
colbr <- function(x, b1=50, b2=50, r1=-2, r2=-2) {
# Min/max values of the raster (x)
mi <- cellStats(x, stat="min")-100
ma <- cellStats(x, stat="max")+100
# Create sequences, but only use unique numbers
s1 <- unique(round(seq(mi, 0, 0-mi/b1),r1))
s2 <- unique(round(seq(0, ma, ma/b2),r2))
# Combine sequence for our break points, removing duplicate 0
s3 <- c(s1, s2[-1])
# Create a list with the outputs
# [[1]] = length of the first sequence minus 1 (water)
# [[2]] = length of the second sequence minus 1 (land)
# [[3]] = The break points
x <- list(length(s1)-1, length(s2)-1, s3)
}
galap.br <- colbr(gebco.crop,b2=1)
# Get country shapefiles
eq <- getData("GADM", country="ECU", level=0)
# Colour palette
blue.col <- colorRampPalette(c("darkblue", "lightblue"))
pdf(width = 8,height=6.5,file="mapBuilding/test.pdf")
plot(gebco.crop, col=c(blue.col(galap.br[[1]]), grey.colors(galap.br[[2]])), breaks=galap.br[[3]],axes = FALSE,box=F,legend = FALSE)
#plot(eq, add=TRUE)
points(metadata$lon2,metadata$lat2,pch=16, col='black',cex=1)
points(metadata$lon2,metadata$lat2,pch=16, col='white',cex=0.5)
dev.off()
as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)]))
metadatSites$island
metadatSites$SiteID
palette
palette(1:12)
palette()
palette()[as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)]))]
cols <- palette()[as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)]))]
cols
pdf(width = 8,height=6.5,file="mapBuilding/test2.pdf")
plot(gebco.crop, col=c(blue.col(galap.br[[1]]), grey.colors(galap.br[[2]])), breaks=galap.br[[3]],axes = FALSE,box=F,legend = FALSE)
#plot(eq, add=TRUE)
points(metadata$lon2,metadata$lat2,pch=16, col='black',cex=1)
points(metadata$lon2,metadata$lat2,pch=16, col=cols,cex=0.5)
dev.off()
plot(gebco.crop, col=c(blue.col(galap.br[[1]]), grey.colors(galap.br[[2]])), breaks=galap.br[[3]],axes = FALSE,box=F,legend = FALSE)
pdf(width = 8,height=6.5,file="mapBuilding/test2.pdf")
plot(gebco.crop, col=c(blue.col(galap.br[[1]]), grey.colors(galap.br[[2]])), breaks=galap.br[[3]],axes = FALSE,box=F,legend = FALSE)
#plot(eq, add=TRUE)
points(metadata$lon2,metadata$lat2,pch=16, col='black',cex=3)
points(metadata$lon2,metadata$lat2,pch=16, col=cols,cex=2)
dev.off()
cols
#Adding in colours per island
cols <- c("#80B1D3","#FFFFB3","#FFFFB3","#80B1D3","#FB8072","#BEBADA","#FFED6F","#CCEBC5",
"#80B1D3","#8DD3C7","#FDB462","#FFFFB3","#B3DE69","gray85,#FFFFB3","#80B1D3",
"#FCCDE5","#80B1D3","#80B1D3","#CCEBC5","#BC80BD","#8DD3C7","#80B1D3")
#Adding in colours per island
cols <- c("#80B1D3","#FFFFB3","#FFFFB3","#80B1D3","#FB8072","#BEBADA","#FFED6F","#CCEBC5",
"#80B1D3","#8DD3C7","#FDB462","#FFFFB3","#B3DE69","gray85,#FFFFB3","#80B1D3",
"#FCCDE5","#80B1D3","#80B1D3","#CCEBC5","#BC80BD","#8DD3C7","#80B1D3")
pdf(width = 8,height=6.5,file="mapBuilding/test2.pdf")
plot(gebco.crop, col=c(blue.col(galap.br[[1]]), grey.colors(galap.br[[2]])), breaks=galap.br[[3]],axes = FALSE,box=F,legend = FALSE)
#plot(eq, add=TRUE)
points(metadata$lon2,metadata$lat2,pch=16, col='black',cex=3)
points(metadata$lon2,metadata$lat2,pch=16, col=cols,cex=2)
dev.off()
#Adding in colours per island
cols <- c("#80B1D3","#FFFFB3","#FFFFB3","#80B1D3","#FB8072","#BEBADA","#FFED6F","#CCEBC5",
"#80B1D3","#8DD3C7","#FDB462","#FFFFB3","#B3DE69","gray85","#FFFFB3","#80B1D3",
"#FCCDE5","#80B1D3","#80B1D3","#CCEBC5","#BC80BD","#8DD3C7","#80B1D3")
pdf(width = 8,height=6.5,file="mapBuilding/test2.pdf")
plot(gebco.crop, col=c(blue.col(galap.br[[1]]), grey.colors(galap.br[[2]])), breaks=galap.br[[3]],axes = FALSE,box=F,legend = FALSE)
#plot(eq, add=TRUE)
points(metadata$lon2,metadata$lat2,pch=16, col='black',cex=3)
points(metadata$lon2,metadata$lat2,pch=16, col=cols,cex=2)
dev.off()
plot(as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),fishAlpha$Richness,
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),
pch=16,
cex=2.5,
ylab="OTUs",
xlab="",
xaxt='n',
main="Teleost and Elasmobranch Richness"
)
axis(1,at=1:12,labels=levels(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),cex=0.2,las=2)
plot(as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),fishAlpha$Richness,
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),
pch=16,
cex=2.5,
ylab="ASV Richness",
xlab="",
xaxt='n'
)
axis(1,at=1:12,labels=levels(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),cex=0.2,las=2)
pdf("figures/FishRichness.pdf",height = 6,width = 8)
plot(as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),fishAlpha$Richness,
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),
pch=16,
cex=2.5,
ylab="ASV Richness",
xlab="",
xaxt='n'
)
axis(1,at=1:12,labels=levels(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),cex=0.2,las=2)
dev.off()
pdf("figures/FishRichness.pdf",height = 5,width = 7)
par(mar=c(5.1, 4.1, 4.1, 2.1))
plot(as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),fishAlpha$Richness,
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),
pch=16,
cex=2.5,
ylab="ASV Richness",
xlab="",
xaxt='n'
)
axis(1,at=1:12,labels=levels(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),cex=0.2,las=2)
dev.off()
pdf("figures/FishRichness.pdf",height = 5,width = 7)
par(mar=c(6.1, 4.1, 2.1, 2.1))
plot(as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),fishAlpha$Richness,
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),
pch=16,
cex=2.5,
ylab="ASV Richness",
xlab="",
xaxt='n'
)
axis(1,at=1:12,labels=levels(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),cex=0.2,las=2)
dev.off()
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])),
main="")
ordihull(nMDS,groups = sites,col = as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])))
sites
sites
?ordihull
ordihull(nMDS,groups = sites,col = "lightgrey",draw = "polygon",lty=0)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])),
main="")
ordihull(nMDS,groups = sites,col = "lightgrey",draw = "polygon",lty=0)
ordihull(nMDS,groups = sites,col = "grey",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])))
ordihull(nMDS,groups = sites,col = "lightgrey",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])))
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])),
main="")
ordihull(nMDS,groups = sites,col = "lightgrey",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])))
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])),
main="")
ordihull(nMDS,groups = sites,col = "grey81",draw = "polygon",lty=0)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])),
main="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])))
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])),
main=""
ylab="")
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])),
main="",
ylab="")
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])),
main="",
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])))
pdf("figures/FishRichness.pdf",height = 5,width = 7)
par(mar=c(2.1, 2.1, 2.1, 2.1))
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])),
main="",
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])))
dev.off()
pdf("figures/FishBetaDiv.pdf",height = 5,width = 7)
par(mar=c(2.1, 2.1, 2.1, 2.1))
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])),
main="",
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])))
dev.off()
pdf("figures/FishRichness.pdf",height = 5,width = 7)
par(mar=c(6.1, 4.1, 2.1, 2.1))
plot(as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),fishAlpha$Richness,
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),
pch=16,
cex=2.5,
ylab="ASV Richness",
xlab="",
xaxt='n'
)
axis(1,at=1:12,labels=levels(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),cex=0.2,las=2)
dev.off()
fishAlpha <- data.frame("ID"=names(fishdatB),"Richness"= colSums(fishdatB))
pdf("figures/FishRichness.pdf",height = 5,width = 6)
par(mar=c(6.1, 4.1, 2.1, 2.1))
plot(as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),fishAlpha$Richness,
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),
pch=16,
cex=2.5,
ylab="ASV Richness",
xlab="",
xaxt='n'
)
axis(1,at=1:12,labels=levels(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),cex=0.2,las=2)
dev.off()
pdf("figures/FishBetaDiv.pdf",height = 5,width = 7)
pdf("figures/FishBetaDiv.pdf",height = 5,width = 6)
par(mar=c(2.1, 2.1, 2.1, 2.1))
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])),
main="",
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])))
dev.off()
