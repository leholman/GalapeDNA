##Can we link richness patterns to oceangraphic distance?
particle <- read.csv("ParticleTracking/TrialStats.csv")
particle3 <- particle[particle$day=="-3",]
particle3o <- particle3[match(fishAlpha$ID,particle3$site),]
pdf("figures/FishRichnessToOceanography.pdf",width =9,height=7)
par(mfrow=c(2,2))
par(mar=c(4.1, 4.1, 2.1, 1.1))
plot(particle3o$mean_spread,
fishAlpha$Richness,
ylab="Fish Richness",
xlab="Average Spread of Particles from Mean (Km)",
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),pch=16,cex=2.5)
plot(particle3o$mean_dist,
fishAlpha$Richness,
ylab="Fish Richness",
xlab="Distance of Particle Centroid from Sampling Site (Km)",
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),pch=16,cex=2.5)
plot(particle3o$area..km.,
fishAlpha$Richness,
ylab="Fish Richness",
xlab="Surface Area of Particles (Km)",
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),pch=16,cex=2.5)
plot(particle3o$ave_dist,
fishAlpha$Richness,
ylab="Fish Richness",
xlab="Average Distance of Particles From Sampling Point (Km)",
col=as.numeric(as.factor(metadatSites$island[match(fishAlpha$ID,metadatSites$SiteID)])),pch=16,cex=2.5)
dev.off()
load("/Users/gwm297/GitHubRepos/GalapeDNA/FranzAnalysis/combined/combined_spatial_framework.edna.rda")
View(combined_spatial_framework.edna)
load("/Users/gwm297/GitHubRepos/GalapeDNA/FranzAnalysis/combined/combined_distances.ednasites.rda")
View(combined_distances.ednasites)
library("metabarTOAD")
library("vegan")
library("Biostrings")
library("RColorBrewer")
library("seqinr")
library("sp")
library("dada2")
#### Settings and Setup####
##Get metadata
metadat <- read.csv("metadata.csv")
metadat.site <- read.csv("metadata.site.csv")
metadat.site$lat2 <- as.numeric(paste0(ifelse(substr(metadat.site$latitude,1,1)=="S","-",""),substr(metadat.site$latitude,3,4),".",substr(as.character(as.numeric(paste0(substr(metadat.site$latitude,6,7),".",substr(metadat.site$latitude,9,11)))/60),3,20)))
metadat.site$lon2 <- as.numeric(paste0(ifelse(substr(metadat.site$longitude,1,1)=="W","-",""),substr(metadat.site$longitude,4,5),".",substr(as.character(as.numeric(paste0(substr(metadat.site$longitude,8,9),".",substr(metadat.site$longitude,11,13)))/60),3,20)))
write.csv(metadat.site,file = "metadata.site.out.csv")
####====0.0 Packages====####
library(vegan)
library("RColorBrewer")
#Set the seed
set.seed("123456")
palette(brewer.pal(12, "Set3"))
####====1.0 Pull in Data ====####
#Fish first
fishAll <- read.csv("cleandata/Cleaned_Fish_wTAX.csv",row.names=1)
fishAssign <- fishAll[,70:86]
fishdat <- fishAll[,1:69]
#Pull out site information
sites <- unlist(lapply(strsplit(colnames(fishdat),"\\."), `[[`, 1))
#Get the metadata
metadat <- read.csv("metadata.csv")
metadatSites <- read.csv("metadata.site.out.csv",row.names=1)
fishdatSite <- as.data.frame(matrix(ncol=length(unique(sites)),nrow=dim(fishdat[1])))
colnames(fishdatSite) <- unique(sites)
rownames(fishdatSite) <- rownames(fishdat)
for (column in colnames(fishdatSite)){
running <- fishdat[,sites==column]
fishdatSite[,colnames(fishdatSite)==column] <- rowMeans(running)
}
fishdatB <- fishdatSite
fishdatB[fishdatB>0] <- 1
fishAlpha <- data.frame("ID"=names(fishdatB),"Richness"= colSums(fishdatB))
View(metadatSites)
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$EcoRegion[match(sites,metadatSites$SiteID)])),
main="",
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$island[match(sites,metadatSites$SiteID)])))
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$EcoRegion[match(sites,metadatSites$SiteID)])),
main="",
ylab="",xlab="")
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$EcoRegion[match(sites,metadatSites$SiteID)])))
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$EcoRegion[match(sites,metadatSites$SiteID)])))
?text
View(nMDS)
colnames(fishdat)
text(nMDS$points[,1],nMDS$points[,2],labels=colnames(fishdat),cex=0.3)
pdf("figures/FishBetaDivEcoRegions.pdf",height = 5,width = 6)
par(mar=c(2.1, 2.1, 2.1, 2.1))
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$EcoRegion[match(sites,metadatSites$SiteID)])),
main="",
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$EcoRegion[match(sites,metadatSites$SiteID)])))
text(nMDS$points[,1],nMDS$points[,2],labels=colnames(fishdat),cex=0.3)
dev.off()
####====0.0 Packages====####
library("vegan")
library("RColorBrewer")
?model.matrix
####====1.0 Pull in Data ====####
#Fish first
fishAll <- read.csv("cleandata/Cleaned_Fish_wTAX.csv",row.names=1)
fishAssign <- fishAll[,70:86]
fishdat <- fishAll[,1:69]
#Pull out site information
sites <- unlist(lapply(strsplit(colnames(fishdat),"\\."), `[[`, 1))
#Get the metadata
metadat <- read.csv("metadata.csv")
metadatSites <- read.csv("metadata.site.out.csv",row.names=1)
View(metadatSites)
test <- model.matrix(SiteID~SiteID,data=metadatSites)
View(test)
?expand.grid()
expand.grid("Start"==metadatSites$SiteID,"End"===metadatSites$SiteID)
expand.grid("Start"==metadatSites$SiteID,"End"==metadatSites$SiteID)
FishDistances <-= expand.grid(Start=metadatSites$SiteID,End=metadatSites$SiteID)
expand.grid(height = seq(60, 80, 5), weight = seq(100, 300, 50),
sex = c("Male","Female"))
as.character(metadatSites$SiteID)
FishDistances <- expand.grid(Start=as.character(metadatSites$SiteID),
End=as.character(metadatSites$SiteID))
View(FishDistances)
FishDistances <- expand.grid(Start=metadatSites$SiteID,
End=metadatSites$SiteID)
View(fishdat)
View(FishDistances)
sitePairwiseDist <- expand.grid(Start=metadatSites$SiteID,
End=metadatSites$SiteID)
install.packages("gDistance")
#calculate some distances 'as-the-fish-swims'
library("gdistance")
#calculate some distances 'as-the-fish-swims'
library('gdistance')
install.packages(('gdistance'))
gebco.crop <- readRDS("mapBuilding/GalapBathy.rds")
hist(gebco.crop@data@values)
gebco.crop
tr1 <- transition(gebco.crop, transitionFunction=mean, directions=16)
#calculate some distances 'as-the-fish-swims'
library('gdistance')
tr1 <- transition(gebco.crop, transitionFunction=mean, directions=16)
gebco.crop2 <- gebco.crop
gebco.crop2@data@values>-1
gebco.crop2data@values[gebco.crop2@data@values>-1] <-0
gebco.crop2@data@values[gebco.crop2@data@values>-1] <-0
gebco.crop2@data@values[gebco.crop2@data@values>-1] <-0
gebco.crop <- readRDS("mapBuilding/GalapBathy.rds")
gebco.crop2 <- gebco.crop
gebco.crop2@data@values[gebco.crop2@data@values>-1] <-0
gebco.crop2@data@values[gebco.crop2@data@values<0] <-1
table(gebco.crop2@data@values)
plot(gebco.crop2)
tr1 <- transition(gebco.crop2, transitionFunction=mean, directions=16)
?costDistance(
)
?costDistance
cbind(c(65,5,-65),c(55,35,-35))
places <- cbind(metadatSites$lat2,metadatSites$lon2)
#Places
places <- cbind(metadatSites$lat2,metadatSites$lon2)
#
tr1 <- transition(gebco.crop2, transitionFunction=mean, directions=16)
tr2 <- geoCorrection(tr1, type="c", multpl=FALSE)
dist <- costDistance(tr2,places)
places
#Places
places <- cbind(metadatSites$lon2,metadatSites$lat2)
dist <- costDistance(tr2,places)
dist
dist <- (costDistance(tr2,places))/100
dist
dist
?costDistance
load("/Users/gwm297/GitHubRepos/GalapeDNA/FranzAnalysis/combined/combined_distances.ednasites.rda")
View(sitePairwiseDist)
View(combined_distances.ednasites)
tr2 <- geoCorrection(tr1, type="c", multpl=TRUE)
dist <- (costDistance(tr2,places))/100
dist
dist <- costDistance(tr2,places)
dist
View(combined_distances.ednasites)
match(combined_distances.ednasites$gid_from,metadatSites$SiteID)
match(combined_distances.ednasites$gid_from,metadatSites$SiteID)
combined_distances.ednasites$lon <- metadatSites$lon2[match(combined_distances.ednasites$gid_from,metadatSites$SiteID)]
?apply
?lapply
for (row in 1:length(combined_distances.ednasites$lat)){
print(row)
}
combined_distances.ednasites$lat
combined_distances.ednasites$lat <- metadatSites$lat2[match(combined_distances.ednasites$gid_from,metadatSites$SiteID)]
combined_distances.ednasites$lon <- metadatSites$lon2[match(combined_distances.ednasites$gid_from,metadatSites$SiteID)]
View(combined_distances.ednasites)
combined_distances.ednasites$Flat <- metadatSites$lat2[match(combined_distances.ednasites$gid_from,metadatSites$SiteID)]
combined_distances.ednasites$Flon <- metadatSites$lon2[match(combined_distances.ednasites$gid_from,metadatSites$SiteID)]
combined_distances.ednasites$Tlat <- metadatSites$lat2[match(combined_distances.ednasites$gid_to,metadatSites$SiteID)]
combined_distances.ednasites$Tlon <- metadatSites$lon2[match(combined_distances.ednasites$gid_to,metadatSites$SiteID)]
View(combined_distances.ednasites)
for (row in 1:length(combined_distances.ednasites$lat)){
print(row)
}
dist <- rep(NA,length(combined_distances.ednasites$lat))
combined_distances.ednasites$Calcdistance <- rep(NA,length(combined_distances.ednasites$lat))
View(combined_distances.ednasites)
costDistance(tr2,c(-1.0387500,-91.15637),c(-0.302816667,-91.65173))
costDistance(tr2,c(-91.15637,-1.0387500),c(-91.65173,-0.302816667))
for (row in 1:length(combined_distances.ednasites$lat)){
combined_distances.ednasites$Calcdistance[row] <-  costDistance(tr2,c(combined_distances.ednasites$Flon[row],
combined_distances.ednasites$Flat[row]),
c(combined_distances.ednasites$Tlon[row],
combined_distances.ednasites$Tlatp[row]))
}
row <- 1
c(combined_distances.ednasites$Flon[row],
combined_distances.ednasites$Flat[row])
c(combined_distances.ednasites$Tlon[row],
combined_distances.ednasites$Tlatp[row])
for (row in 1:length(combined_distances.ednasites$lat)){
combined_distances.ednasites$Calcdistance[row] <-  costDistance(tr2,c(combined_distances.ednasites$Flon[row],
combined_distances.ednasites$Flat[row]),
c(combined_distances.ednasites$Tlon[row],
combined_distances.ednasites$Tlat[row]))
}
for (row in 1:10){
combined_distances.ednasites$Calcdistance[row] <-  costDistance(tr2,c(combined_distances.ednasites$Flon[row],
combined_distances.ednasites$Flat[row]),
c(combined_distances.ednasites$Tlon[row],
combined_distances.ednasites$Tlat[row]))
}
View(combined_distances.ednasites)
plot(combined_distances.ednasites$distance_m[1:100],combined_distances.ednasites$Calcdistance[1:100])
c(combined_distances.ednasites$gid_from,combined_distances.ednasites$gid_to)
plot(combined_distances.ednasites$distance_m[1:100],combined_distances.ednasites$Calcdistance[1:100])
text(combined_distances.ednasites$distance_m[1:100],combined_distances.ednasites$Calcdistance[1:100],
labels=cbind(combined_distances.ednasites$gid_from[1:100],combined_distances.ednasites$gid_to[1:100]))
plot(combined_distances.ednasites$distance_m[1:100],combined_distances.ednasites$Calcdistance[1:100])
text(combined_distances.ednasites$distance_m[1:100],combined_distances.ednasites$Calcdistance[1:100],
labels=paste0(combined_distances.ednasites$gid_from[1:100],combined_distances.ednasites$gid_to[1:100]))
plot(combined_distances.ednasites$distance_m[1:100],combined_distances.ednasites$Calcdistance[1:100])
View(FishDistances)
View(combined_distances.ednasites)
load("/Users/gwm297/GitHubRepos/GalapeDNA/FranzAnalysis/combined/combined_spatial_framework.edna.rda")
View(combined_spatial_framework.edna)
#Places
places <- cbind(metadatSites$lon2,metadatSites$lat2)
sitePairwiseDist <- expand.grid(Start=metadatSites$SiteID,
End=metadatSites$SiteID)
View(sitePairwiseDist)
sitePairwiseDist$Flat <- metadatSites$lat2[match(sitePairwiseDist$Start,metadatSites$SiteID)]
sitePairwiseDist$Flon <- metadatSites$lon2[match(sitePairwiseDist$Start,metadatSites$SiteID)]
sitePairwiseDist$Tlat <- metadatSites$lat2[match(sitePairwiseDist$End,metadatSites$SiteID)]
sitePairwiseDist$Tlon <- metadatSites$lon2[match(sitePairwiseDist$End,metadatSites$SiteID)]
sitePairwiseDist$Calcdistance <- rep(NA,length(sitePairwiseDist$End))
View(sitePairwiseDist)
for (row in length(sitePairwiseDist$End)){
sitePairwiseDist$Calcdistance[row] <-  costDistance(tr2,c(sitePairwiseDist$Flon[row],
sitePairwiseDist$Flat[row]),
c(sitePairwiseDist$Tlon[row],
sitePairwiseDist$Tlat[row]))
}
View(sitePairwiseDist)
row <- 1
sitePairwiseDist$Calcdistance[row] <-  costDistance(tr2,c(sitePairwiseDist$Flon[row],
sitePairwiseDist$Flat[row]),
c(sitePairwiseDist$Tlon[row],
sitePairwiseDist$Tlat[row]))
View(sitePairwiseDist)
for (row in 1:length(sitePairwiseDist$End)){
sitePairwiseDist$Calcdistance[row] <-  costDistance(tr2,c(sitePairwiseDist$Flon[row],
sitePairwiseDist$Flat[row]),
c(sitePairwiseDist$Tlon[row],
sitePairwiseDist$Tlat[row]))
}
test <- costDistance(tr2,cbind(sitePairwiseDist$Flon,sitePairwiseDist$Flat),
cbind(sitePairwiseDist$Tlon,sitePairwiseDist$Tlat))
View(test)
for (row in 1:length(sitePairwiseDist$End)){
sitePairwiseDist$Calcdistance[row] <-  costDistance(tr2,c(sitePairwiseDist$Flon[row],
sitePairwiseDist$Flat[row]),
c(sitePairwiseDist$Tlon[row],
sitePairwiseDist$Tlat[row]))
}
for (row in 1:length(sitePairwiseDist$End)){
sitePairwiseDist$Calcdistance[row] <-  costDistance(tr2,c(sitePairwiseDist$Flon[row],
sitePairwiseDist$Flat[row]),
c(sitePairwiseDist$Tlon[row],
sitePairwiseDist$Tlat[row]))
print(row)
}
View(FishDistances)
View(sitePairwiseDist)
write.csv(sitePairwiseDist,"SiteDistance.csv")
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$EcoRegion[match(sites,metadatSites$SiteID)])),
main="",
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$EcoRegion[match(sites,metadatSites$SiteID)])))
text(nMDS$points[,1],nMDS$points[,2],labels=colnames(fishdat),cex=0.3)
?adonis
?adonis2
View(fishAll)
View(metadat)
View(metadatSites)
View(fishdat)
colnames(fishdat)
View(metadatSites)
View(metadat)
str.split(colnames(fishdat),"\\.")
strsplit(colnames(fishdat),"\\.")
apply(strsplit(colnames(fishdat),"\\."),"[",1)
sapply(strsplit(colnames(fishdat),"\\."),"[",1)
groups <- sapply(strsplit(colnames(fishdat),"\\."),"[",1)
groups0 <- sapply(strsplit(colnames(fishdat),"\\."),"[",1)
groups1 <- metadatSites$EcoRegion[metadatSites$SiteID==groups0]
metadatSites$SiteID
metadatSites$EcoRegion
groups0
match(metadatSites$SiteID,groups0)
groups1 <- metadatSites$EcoRegion[match(groups0,metadatSites$SiteID)]
groups0=="RED"
groups2 <- groups1
groups2
groups2[groups0=="RED"]<-"Northern"
groups1
groups2
groups0 <- sapply(strsplit(colnames(fishdat),"\\."),"[",1)
#Groups 1 as ecoregions
groups1 <- metadatSites$EcoRegion[match(groups0,metadatSites$SiteID)]
#Groups 2 w/ RED as Northern
groups2 <- groups1
groups2[groups0=="RED"]<-"Northern"
#ius the variance between ecoregions similar? -  lets run a PERMdisp
fishbetadisp <- betadisper(vegdist(t(fishdat), "jaccard",binary=TRUE),groups1)
anova(PermDispCOI.met)
anova(fishbetadisp)
#ius the variance between ecoregions similar? -  lets run a PERMdisp
fishbetadisp <- betadisper(vegdist(t(fishdat), "jaccard",binary=TRUE),groups2)
anova(fishbetadisp)
#No sig difference in multivariate homogeneity
adonis2(vegdist(t(fishdat), "jaccard",binary=TRUE)~groups1)
#No sig difference in multivariate homogeneity
adonis2(vegdist(t(fishdat), "jaccard",binary=TRUE)~groups2)
#No sig difference in multivariate homogeneity
adonis2(vegdist(t(fishdat), "jaccard",binary=TRUE)~groups2,permutations = 1000)
as.numeric(groups2)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
main="",
col=as.numeric(as.factor(groups2)),
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
main="",
col=as.numeric(as.factor(groups2)),
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(groups2)))
pdf("figures/FishBetaDivEcoRegions2.pdf",height = 5,width = 6)
par(mar=c(2.1, 2.1, 2.1, 2.1))
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
main="",
col=as.numeric(as.factor(groups2)),
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(groups2)))
dev.off()
####====0.0 Packages====####
library("vegan")
library("RColorBrewer")
#Set the seed
set.seed("123456")
palette(brewer.pal(12, "Set3"))
####====1.0 Pull in Data ====####
#Fish first
fishAll <- read.csv("cleandata/Cleaned_Fish_wTAX.csv",row.names=1)
fishAssign <- fishAll[,70:86]
fishdat <- fishAll[,1:69]
#Pull out site information
sites <- unlist(lapply(strsplit(colnames(fishdat),"\\."), `[[`, 1))
#Get the metadata
metadat <- read.csv("metadata.csv")
metadatSites <- read.csv("metadata.site.out.csv",row.names=1)
#Make a dataset across sites with mean values
fishdatSite <- as.data.frame(matrix(ncol=length(unique(sites)),nrow=dim(fishdat[1])))
colnames(fishdatSite) <- unique(sites)
rownames(fishdatSite) <- rownames(fishdat)
for (column in colnames(fishdatSite)){
running <- fishdat[,sites==column]
fishdatSite[,colnames(fishdatSite)==column] <- rowMeans(running)
}
pdf("figures/FishBetaDivEcoRegions1.pdf",height = 5,width = 6)
par(mar=c(2.1, 2.1, 2.1, 2.1))
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$EcoRegion[match(sites,metadatSites$SiteID)])),
main="",
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$EcoRegion[match(sites,metadatSites$SiteID)])))
text(nMDS$points[,1],nMDS$points[,2],labels=colnames(fishdat),cex=0.3)
dev.off()
groups0 <- sapply(strsplit(colnames(fishdat),"\\."),"[",1)
#Groups 1 as ecoregions
groups1 <- metadatSites$EcoRegion[match(groups0,metadatSites$SiteID)]
#Groups 2 w/ RED as Northern
groups2 <- groups1
groups2[groups0=="RED"]<-"Northern"
#ius the variance between ecoregions similar? -  lets run a PERMdisp
fishbetadisp <- betadisper(vegdist(t(fishdat), "jaccard",binary=TRUE),groups1)
anova(fishbetadisp)
#Is there a sig diff in PERMANOVA between ecoregions?
adonis2(vegdist(t(fishdat), "jaccard",binary=TRUE)~groups2,permutations = 1000)
par(mar=c(2.1, 2.1, 2.1, 2.1))
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
main="",
col=as.numeric(as.factor(groups2)),
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(groups2)))
text(nMDS$points[,1],nMDS$points[,2],labels=colnames(fishdat),cex=0.3)
pdf("figures/FishBetaDivEcoRegions2.pdf",height = 5,width = 6)
par(mar=c(2.1, 2.1, 2.1, 2.1))
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
main="",
col=as.numeric(as.factor(groups2)),
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(groups2)))
text(nMDS$points[,1],nMDS$points[,2],labels=colnames(fishdat),cex=0.3)
dev.off()
pdf("figures/FishBetaDivEcoRegions1.pdf",height = 5,width = 6)
par(mar=c(2.1, 2.1, 2.1, 2.1))
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
col=as.numeric(as.factor(metadatSites$EcoRegion[match(sites,metadatSites$SiteID)])),
main="",
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(metadatSites$EcoRegion[match(sites,metadatSites$SiteID)])))
text(nMDS$points[,1],nMDS$points[,2],labels=colnames(fishdat),cex=0.3)
dev.off()
groups0 <- sapply(strsplit(colnames(fishdat),"\\."),"[",1)
#Groups 1 as ecoregions
groups1 <- metadatSites$EcoRegion[match(groups0,metadatSites$SiteID)]
#Groups 2 w/ RED as Northern
groups2 <- groups1
groups2[groups0=="RED"]<-"Northern"
#ius the variance between ecoregions similar? -  lets run a PERMdisp
fishbetadisp <- betadisper(vegdist(t(fishdat), "jaccard",binary=TRUE),groups1)
anova(fishbetadisp)
#Is there a sig diff in PERMANOVA between ecoregions?
adonis2(vegdist(t(fishdat), "jaccard",binary=TRUE)~groups2,permutations = 1000)
pdf("figures/FishBetaDivEcoRegions2.pdf",height = 5,width = 6)
par(mar=c(2.1, 2.1, 2.1, 2.1))
nMDS <- metaMDS(vegdist(t(fishdat),method="jaccard",binary=TRUE),trymax=500)
plot(nMDS$points[,1],nMDS$points[,2],
pch=16,
cex=1.5,
main="",
col=as.numeric(as.factor(groups2)),
ylab="",xlab="")
ordihull(nMDS,groups = sites,col = "grey71",draw = "polygon",lty=0)
points(nMDS$points[,1],nMDS$points[,2],pch=16,cex=1.5,
col=as.numeric(as.factor(groups2)))
text(nMDS$points[,1],nMDS$points[,2],labels=colnames(fishdat),cex=0.3)
dev.off()
